{# Detail info about a particular meet, at /meets/<meet-id> #}
{% extends "secondary_nav.html.j2" %}
{% block secondary_nav_title %}
    {{ meet.name }}
{% endblock secondary_nav_title %}

{% block nav2_admin_url %}
    href="/meets/{{ meet.id }}/admin"
{% endblock nav2_admin_url %}>

{% block nav2_subtitle %}
    <div>
        <a href="{{ url_for('show_school_detail', school_id=meet.host_school.id) }}">
            Host School: {{ meet.host_school.name }}
        </a>
    <div>{{ meet.date.strftime("%B %d, %Y") }}</div>
{% endblock nav2_subtitle %}


{% block tab1_name %}
    Event Schedule
{% endblock tab1_name %}

{% block tab2_name %}
    Schools
{% endblock tab2_name %}

{% block tab3_name %}
    Athletes
{% endblock tab3_name %}

{% block tab4_name %}
    Meet Information
{% endblock tab4_name %}

{# The expandable event cards that are on the accordions on   #}
{# MeetDetail > Schedule of events  #}
{% block tab1_content %}
    <div class="row">
        <div id="track-event-accordion" class="col-lg-6 col">
            <h5 class="card-header bg-info text-white">TrackEvents</h5>
            {% for event in meet.events %}
                {% if event.is_track() %}
                    {{ show_event_card(meet, "track", event) }}
                {% endif %}
            {% endfor %}
        </div>    {# track-event-accordion #}
        <div id="field-event-accordion" class="col-lg-6 col">
            <h5 class="card-header bg-info text-white">FieldEvents</h5>
            {% for event in meet.events %}
                {% if event.is_field() %}
                    {{ show_event_card(meet, "field", event) }}
                {% endif %}
            {% endfor %}
        </div>    {# field-event-accordion #}
    </div>
{% endblock tab1_content %}

{% block tab2_content %}
    <p>This lists the schools in the meet</p>
{% endblock tab2_content %}

{% block tab3_content %}
    <p>This lists the athletes in the meet</p>
{% endblock tab3_content %}

{% block tab4_content %}
    <p>{{meet.description}}</p>
{% endblock tab4_content %}


{#  MACROS DEFINITION TO HANDLE THE EVENT ACCORDIONS #}
{% macro show_event_card(meet, ev_type, event) %}
<div class="card">
    <div class="card-header" id="{{ event.name }}">
        <button class="btn btn-link justify-content-between" data-toggle="collapse" data-target="#collapse{{event.code}}" aria-expanded="true" aria-controls=""collapse{{event.code}}">
            <span class="mr-auto">{{ event.name }} :&nbsp;</span>
            <span class-"badge badge-secondary">
                {{ meet.get_event_athlete_count(event) }} athletes
            </span>
        </button>
    </div>
    <div id="collapse{{event.code}}" class="collapse" aria-labelledby="{{event.code}}" data-parent="#{{ ev_type }}-event-accordion">
        <div class="card-body">
            <ul class="list-group">
                {% for mde in meet.get_event_mdes(event) %}
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <a href="/meets/{{ meet.id }}/mdes/{{ mde.id }}">
                            {{ mde.division.name }}
                        </a>
                        <span class="badge badge-secondary"><strong>{{ mde.entries|length }} entries</strong></span>
                    </li>
                {% endfor %}
            </ul>
        </div>
    </div>
</div>
{% endmacro %}